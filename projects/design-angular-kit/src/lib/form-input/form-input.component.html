<div class="form-group">
  <div class="input-group" *ngIf = "isInputGroup; else formInput">
      <ng-container *ngIf="_textPrefixChildren.length || _prefixChildren.length || icon">
        <div class="input-group-prepend">

          <!-- Gli elementi figli di "it-input" con la direttiva "itTextPrefix"  -->
          <ng-container *ngIf="_textPrefixChildren.length || icon">

            <div class="input-group-text" >
              <ng-container *ngIf="icon">
                <it-icon [icon] = "icon" size="icon-sm"></it-icon>
              </ng-container>

              <ng-container *ngIf="_textPrefixChildren.length">
                <ng-content select = "[itTextPrefix]"></ng-content>
              </ng-container>
            </div>
          </ng-container>
         
          <ng-container *ngIf="_prefixChildren.length">
            <!-- Gli elementi figli di "it-input" con la direttiva "itPrefix"  -->
            <ng-content select = "[itPrefix]"></ng-content>
          </ng-container>
        </div>
      </ng-container>

      <ng-container [ngTemplateOutlet]="formInput"></ng-container>

      <ng-container *ngIf="_suffixChildren.length || _textSuffixChildren.length">
        <div  class="input-group-append">
          <!-- Gli elementi figli di "it-input" con la direttiva "itTextSuffix"  -->
          <ng-container *ngIf="_textSuffixChildren.length">
            <div class="input-group-text" >
              <ng-content select = "[itTextSuffix]"></ng-content>
            </div>
          </ng-container>
         
          <ng-container *ngIf="_suffixChildren.length">
            <!-- Gli elementi figli di "it-input" con la direttiva "itSuffix"  -->
            <ng-content select = "[itSuffix]"></ng-content>
          </ng-container>
        </div>
      </ng-container>
      
    
  </div>

  <ng-template #formInput>
    <label [attr.for]="id" [class.active] = "isLabelActive" *ngIf="label">
      {{label}}
    </label>
  
    <input #inputElement
      (focus)="onFocus()"
      (blur)="onBlur()"
      (change)="onChange()"
      (input)="onInput()"
      [type]="type"
      [id]="id"
      [class.focus--mouse]="focus"
      [class.input-password]="isPasswordMode"
      [attr.name]="name"
      [disabled]="disabled"
      [readonly]="readonly"
      [placeholder]="placeholder"
      [ngClass]="{
        'form-control' : !readonly,
        'form-control-plaintext' : readonly,
        'autocomplete' : isAutocompletable()
      }"
    [attr.aria-describedby]="note ? noteId : undefined"/>    
  </ng-template>

  <small [id]="noteId" class="form-text" *ngIf="note">
    {{note}}
  </small>


  <ng-container *ngIf="isPasswordMode">
    <!-- Icona dell'occhio per la vedere/nascondere la password -->
    <span 
      class = "password-icon"
      aria-hidden="true"
      (click)="isPasswordVisible = !isPasswordVisible">
      <it-icon [icon]="'it-password-' + (isPasswordVisible ? 'visible' : 'invisible')" size="icon-sm" color="default"></it-icon>
    </span>


    <!-- Indicatore di sicurezza della password -->
    <div class="password-strength-meter" *ngIf="isPasswordMode && enablePasswordStrengthMeter">
      <small class="form-text" 
        [class.text-muted]="passwordStrengthLevel === 0"
        [class.text-danger]="passwordStrengthLevel === 1"
        [class.text-warning]="passwordStrengthLevel === 2"
        [class.text-success]="passwordStrengthLevel > 2"
        *ngIf = "passwordStrengthMeterConfig.showText">{{ passwordStrengthStatusMessage}}
      </small>
      <div class="password-meter progress rounded-0 position-absolute">
        <div class="row position-absolute w-100 m-0">
          <div class="col-3 border-start border-end border-white"></div>
          <div class="col-3 border-start border-end border-white"></div>
          <div class="col-3 border-start border-end border-white"></div>
          <div class="col-3 border-start border-end border-white"></div>
        </div>

        <div class="progress-bar" 
          [class.bg-success]="passwordStrengthLevel > 2" 
          [class.bg-warning]="passwordStrengthLevel === 2" 
          [class.bg-danger]="passwordStrengthLevel === 1" 
          role="progressbar" [attr.aria-valuenow]="passwordStrength" aria-valuemin="0" aria-valuemax="100" [style.width.%]="passwordStrength">
        </div>
      </div>
    </div>

  </ng-container>
  


  <ul class="autocomplete-wrap" *ngIf="isAutocompletable()">
    <li *ngFor="let entry of getRelatedEntries()" (click)="onEntryClick(entry)">
      {{entry}}
    </li>
  </ul>

</div>
